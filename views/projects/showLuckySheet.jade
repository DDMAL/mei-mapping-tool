doctype html
html
  include includes/projectHead.jade

//Header parameters
   //Column parameters
//- - each user in users
include includes/projectHeader.jade
include includes/projectNav.jade

//Title section : Adding a neume button and changing the title name                
div.neumeSection(style = "display: block; top : 170px; position: relative; min-height: calc(100% - 170px)" id="neume-sheet")

script. 
  var neumes = !{JSON.stringify(neumes)}; 
  var neume_data = []
  neumes.forEach((neume) => {
    console.log(neume);
    neume_data.push([
      "data:image/jpeg;base64," + neume.imagesBinary[0], // image binary
      neume.name, //name of neume
      neume.genericName,
      neume.folio,
      neume.description,
      neume.classification,
      neume.mei,
    ])
  }); 

  var customColumn = {
      // Methods
      closeEditor : function(cell, save) {
          var value = cell.children[0].value;
          //- var xmlText = new XMLSerializer().serializeToString(value);
          var xmlTextNode = document.createTextNode(value);
          cell.innerHTML = xmlTextNode;
          console.log('close');
          return value;
      },
      openEditor : function(cell) {
          // Create input
          console.log('open');
          var element = document.createElement('textarea');
          element.value = cell.innerHTML;
          // Update cell
          cell.classList.add('editor');
          cell.innerHTML = '';
          cell.appendChild(element);
          // Focus on the element
          element.focus();
      },
      getValue : function(cell) {
          console.log('get');
          return cell.innerHTML;
      },
      setValue : function(cell, value) {
          console.log('set');
          cell.innerHTML = value;
      }
  }

  projectTable = jexcel(document.getElementById('neume-sheet'), {
      data:neume_data,
      minDimensions: [2,4],
      columns: [
        { type:'image', width:120, title:'Cover' },
        { type:'text', width:100, title:'Title' },
        { type:'text', width:100, title:'Generic Name' },
        { type:'text', width:100, title:'Folio' },
        { type:'text', width:100, title:'Description' },
        { type:'text', width:100, title:'Classification' },
        { type:'text', width:100, title:'MEI', wordWrap: true},
      ],
      defaultColAlign: 'left',
  });

//- script(src='/javascripts/projectSheet.js') 
script(src='//www.termsfeed.com/cookie-consent/releases/3.0.0/cookie-consent.js')
script.

  document.addEventListener('DOMContentLoaded', function () {
  cookieconsent.run({"notice_banner_type":"interstitial","consent_type":"express","palette":"light","change_preferences_selector":"#changePreferences","language":"en","website_name":"Cress"});
  });
  insertAfter(document.getElementById("section"), document.getElementById("roundedCorners"));
  function insertAfter(newNode, referenceNode) {
    referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
  }
   var neumeArray = [];
<noscript>Cookie Consent by <a href="https://www.termsfeed.com/">TermsFeed</a></noscript>
<!-- End Cookie Consent -->                                          
                                       
